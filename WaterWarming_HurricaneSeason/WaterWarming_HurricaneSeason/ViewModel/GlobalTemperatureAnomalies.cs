using System;
using System.Collections.Generic;
using System.Collections.ObjectModel;
using System.Globalization;
using System.IO;
using System.Linq;
using System.Reflection;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Media;
using System.Windows.Shapes;

namespace WaterWarming_HurricaneSeason
{
    public class GlobalTemperatureAnomalies
    {
        private ObservableCollection<YearlyTemperatureAnomaly> collection;
        public ObservableCollection<YearlyTemperatureAnomaly> CollectionOfTemperature
        {
            set { collection = value; }
            get { return collection; }
        }

        private Geometry path = Geometry.Parse("M11.065994,11.730998C7.5180054,11.730998 4.6320038,14.788997 4.6320038,18.546992 4.6320038,19.296992 4.753006,20.046992 4.9920044,20.775996 5.0800018,21.046 5.0500031,21.339992 4.9089966,21.585994 4.7669983,21.831996 4.5279999,22.005992 4.2509918,22.065989 2.9459991,22.344995 2,23.581995 2,25.006998 2,26.661997 3.2579956,28.006998 4.8040009,28.006998L27.194992,28.006998C28.742004,28.006998 30,26.661997 30,25.006998 30,23.352991 28.742004,22.006999 27.194992,22.006999 27.026993,22.006999 26.847992,22.029993 26.647995,22.074991 26.285004,22.156992 25.910004,22.034998 25.667999,21.753993 25.425995,21.475001 25.358002,21.083995 25.492004,20.738994 25.677002,20.262996 25.770996,19.781993 25.770996,19.309993 25.770996,17.120997 23.990005,15.340999 21.802002,15.340999 20.666,15.340999 19.615005,15.820994 18.843994,16.692988 18.606003,16.962001 18.242996,17.082988 17.889999,17.00999 17.539001,16.936 17.253006,16.679988 17.143005,16.337993 16.253006,13.582988 13.811005,11.730998 11.065994,11.730998z M28.174994,11.702003L30.575994,11.702003C31.127995,11.702003 31.575994,12.150003 31.575994,12.702003 31.575994,13.254003 31.127995,13.702003 30.575994,13.702003L28.174994,13.702003C27.621994,13.702003 27.174995,13.254003 27.174995,12.702003 27.174995,12.150003 27.621994,11.702003 28.174994,11.702003z M18.874834,8.1880107C17.207542,8.1880106,15.681211,9.1277374,14.903145,10.556082L14.845211,10.667784 14.91758,10.705135C16.415791,11.511184 17.668369,12.779621 18.483994,14.367 19.460999,13.704997 20.613998,13.340999 21.802002,13.340999 22.316221,13.340999 22.815474,13.406379 23.291883,13.529263L23.311079,13.534728 23.317574,13.502512C23.36445,13.239762 23.387951,12.972012 23.387951,12.701012 23.387951,10.212011 21.363899,8.1880106 18.874834,8.1880107z M18.874834,6.1880102C22.465927,6.18801 25.388002,9.1100108 25.388002,12.701012 25.388002,13.189137 25.334875,13.670621 25.228867,14.140094L25.167974,14.384018 25.370947,14.528468C26.826899,15.618039 27.770996,17.355961 27.770996,19.309993 27.770996,19.551997 27.755005,19.794993 27.723999,20.036998 30.125,20.311992 32,22.435999 32,25.006998 32,27.763987 29.843994,30.006998 27.194992,30.006998L4.8040009,30.006998C2.1549988,30.006998 0,27.763987 0,25.006998 0,23.016993 1.1450043,21.240993 2.8339996,20.446986 2.6999969,19.819987 2.6320038,19.184001 2.6320038,18.546992 2.6320038,13.686 6.4160004,9.7309983 11.065994,9.7309985 11.654183,9.7309985 12.231614,9.7947717 12.791201,9.9170055L12.967604,9.9588213 13.023791,9.8387027C14.104431,7.6465261,16.380146,6.18801,18.874834,6.1880102z M27.148994,3.4280024C27.404905,3.4280024 27.66069,3.5257459 27.855715,3.7212329 28.246769,4.1112075 28.246769,4.7441659 27.855715,5.1351404L26.157486,6.8330293C25.96246,7.0280166 25.706427,7.1260102 25.450392,7.1260099 25.194357,7.1260102 24.938322,7.0280166 24.743296,6.8330293 24.352243,6.4420547 24.352243,5.8100963 24.743296,5.4191217L26.441525,3.7212329C26.637051,3.5257459,26.893085,3.4280024,27.148994,3.4280024z M10.600016,3.4280024C10.855925,3.4280024,11.111959,3.5257459,11.307486,3.7212329L13.005714,5.4191217C13.396768,5.8100963 13.396768,6.4420547 13.005714,6.8330293 12.810689,7.0280166 12.554654,7.1260102 12.298619,7.1260099 12.042585,7.1260102 11.786551,7.0280166 11.591524,6.8330293L9.8932953,5.1351404C9.502243,4.7441659 9.502243,4.1112075 9.8932953,3.7212329 10.088322,3.5257459 10.344107,3.4280024 10.600016,3.4280024z M18.874996,0C19.426996,0,19.874996,0.44800091,19.874996,1.0000019L19.874996,3.4020057C19.874996,3.9540067 19.426996,4.4020076 18.874996,4.4020076 18.322996,4.4020076 17.874996,3.9540067 17.874996,3.4020057L17.874996,1.0000019C17.874996,0.44800091,18.322996,0,18.874996,0z");

        public Geometry PathData
        {
            set { path = value; }
            get { return path; }
        }


        public GlobalTemperatureAnomalies()
        {
            CollectionOfTemperature = new ObservableCollection<YearlyTemperatureAnomaly>(ReadCSV("WaterWarming_HurricaneSeason.TemperatureAnomalies.csv"));
        }

        public IEnumerable<YearlyTemperatureAnomaly> ReadCSV(string fileName)
        {
            Assembly executingAssembly = typeof(App).GetTypeInfo().Assembly;
            Stream inputStream = executingAssembly.GetManifestResourceStream(fileName);
            List<string> lines = new List<string>();
            List<YearlyTemperatureAnomaly> collection = new List<YearlyTemperatureAnomaly>();

            if (inputStream != null)
            {
                string line;
                StreamReader reader = new StreamReader(inputStream);
                while ((line = reader.ReadLine()) != null)
                {
                    lines.Add(line);
                }
                lines.RemoveAt(0);

                foreach (var dataPoint in lines)
                {
                    string[] data = dataPoint.Split(',');
                    DateTime date = DateTime.ParseExact(data[0], "yyyy", CultureInfo.InvariantCulture);
                    collection.Add(new YearlyTemperatureAnomaly(date, Convert.ToDouble(data[1])));
                }

                return collection;
            }

            return collection;

        }
    }
}
